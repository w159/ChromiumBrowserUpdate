$ProgressPreference = 'SilentlyContinue'
New-Item -Path C:\ -Name Utils -ItemType Directory -Force -ErrorAction SilentlyContinue

$ChromeMSI = "C:\Utils\googlechromestandaloneenterprise.msi"

Invoke-WebRequest -UseBasicParsing "https://dl.google.com/chrome/install/GoogleChromeStandaloneEnterprise.msi" -OutFile $ChromeMSI

$ChromeLatestInstaller = $ChromeMSI
$Shell = New-Object -COMObject Shell.Application
$folder = Split-Path $ChromeLatestInstaller
$file = Split-Path $ChromeLatestInstaller -Leaf
$Shellfolder = $Shell.Namespace($folder)
$Shellfile = $Shellfolder.ParseName($file)

$ChromeVersionCheck = $Shellfolder.GetDetailsOf($Shellfile, 24)
$ChromeCurrentVersion = $ChromeVersionCheck.Substring(0, $ChromeVersionCheck.IndexOf(' '))

New-Item -Path C:\Utils -Name ChromeLatestVersion.log -ItemType File -Value $ChromeCurrentVersion -Force -ErrorAction SilentlyContinue

$ChromeLatestVersion = Get-Content -Path C:\ChromeLatestVersion.log
$ChromeCheck = Get-WmiObject win32_product | Where Name -like *Chrome* | Select -ExpandProperty Name
$ChromeVersion = Get-WmiObject win32_product | Where Name -like *Chrome* | Select -ExpandProperty Version

If ($ChromeCheck -ne "Google Chrome"){

            $ChromeTestPath = Test-Path "C:\Program Files\Google\Chrome\Application\Chrome.exe"
            $ChromeTestPathX86 = Test-Path "C:\Program Files (x86)\Google\Chrome\Application\Chrome.exe"
            
            If ($ChromeTestPath -eq $true){

                $ChromeEXE = "C:\Program Files\Google\Chrome\Application\Chrome.exe"
                $ChromeInstalledVersion = (Get-Item $ChromeEXE).VersionInfo | Select -ExpandProperty ProductVersion

                If ($ChromeInstalledVersion -ne $ChromeCurrentVersion) {
                                                                       
                                                                       Unblock-File $ChromeMSI
                                                                       msiexec.exe /i $ChromeMSI /qn /norestart

                                                                       }
                
                                       }

            If ($ChromeTestPathX86 -eq $true){

                $ChromeX86EXE = "C:\Program Files (x86)\Google\Chrome\Application\Chrome.exe"
                $ChromeInstalledVersion = (Get-Item $ChromeX86EXE).VersionInfo | Select -ExpandProperty ProductVersion

                If ($ChromeInstalledVersion -ne $ChromeCurrentVersion) {
                                                                       
                                                                       Unblock-File $ChromeMSI
                                                                       msiexec.exe /i $ChromeMSI /qn /norestart

                                                                       }

                                            }

                                      }

If ($ChromeVersion -ne "$ChromeLatestVersion")

                             {

                                Unblock-File $ChromeMSI
                                msiexec.exe /i $ChromeMSI /qn /norestart
                             
                             }
